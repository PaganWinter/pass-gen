<html>
<head>
  <title>Password Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<form>
  <input type="text" id="passphrase" placeholder="master passphrase" /><br />
  <input type="text" id="account" placeholder="account" />
  <input type="text" id="service" placeholder="service" />
  <input type="text" id="variant" placeholder="variant" />
  <input type="text" id="special" placeholder="special char" /><br />
  <input type="button" id="generate" value="Generate" onclick="doGeneratePassword()" />
  <input type="button" id="clear" value="Clear" onclick="clearAll()" /><br />
  <pre id="password"></pre>
  <pre id="metadata"></pre>
</form>
<script src="pass-gen.js"></script>
<script>
const { generatePassword } = passgen
let passphraseEl = document.getElementById('passphrase')
let accountEl = document.getElementById('account')
let serviceEl = document.getElementById('service')
let variantEl = document.getElementById('variant')
let specialEl = document.getElementById('special')
let passwordEl = document.getElementById('password')
let metadataEl = document.getElementById('metadata')

function clearAll() {
  passphrase.value = ''
  accountEl.value = ''
  serviceEl.value = ''
  variantEl.value = ''
  specialEl.value = ''
  passwordEl.innerHTML = ''
  metadataEl.innerHTML = ''
  navigator.clipboard.writeText('').then().catch(() => alert('could not clear clipboard'))
}
async function doGeneratePassword() {
  let passphrase = passphraseEl.value
  let account = accountEl.value
  let service = serviceEl.value
  let variant = variantEl.value
  let special = specialEl.value
  let opts = { passphrase, account, service, variant, special }

  let passObj = await generatePassword(opts)
  console.log(passObj)
  passwordEl.innerHTML = passObj.password
  metadataEl.innerHTML = JSON.stringify(passObj, 0, 2)

  navigator.clipboard.writeText(passObj.password).then().catch(() => alert('could not copy'))
  /*
  try {
    document.execCommand('copy')
  } catch (err) {
    alert('Unable to Copy')
  }
  */
}
</script>
</body>
</html>